# ================================================
# CAP Platform Backend Environment Configuration
# Copy this file to .env and update values as needed
# ================================================

# ================================
# Core Application Settings
# ================================
APP_NAME=CAP Platform
APP_VERSION=1.0.0
APP_DESCRIPTION=Conversational AI Platform
ENVIRONMENT=development
DEBUG=true
PROJECT_NAME=CAP Platform API

# ================================
# API Configuration
# ================================
API_V1_STR=/api/v1

# ================================
# Security Configuration
# ================================
SECRET_KEY=your-super-secret-key-minimum-32-characters-long-please-change-this
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7
ALGORITHM=HS256

# ================================
# CORS Configuration
# ================================
# Comma-separated list or JSON array of allowed origins
BACKEND_CORS_ORIGINS=http://localhost:3000,http://localhost:8000
# Example JSON format: BACKEND_CORS_ORIGINS=["http://localhost:3000", "http://localhost:8000"]

# ================================
# Database Configuration
# ================================

# PostgreSQL (Primary Database)
POSTGRES_SERVER=postgres
POSTGRES_PORT=5432
POSTGRES_USER=cap_user
POSTGRES_PASSWORD=cap_password
POSTGRES_DB=cap_platform

# MongoDB (Document Storage)
MONGODB_URL=mongodb://cap_user:cap_password@mongodb:27017/cap_conversations
MONGODB_DB_NAME=cap_conversations

# Legacy MongoDB settings (optional, for backward compatibility)
MONGODB_SERVER=mongodb
MONGODB_PORT=27017
MONGODB_USER=cap_user
MONGODB_PASSWORD=cap_password
MONGODB_DB=cap_conversations

# ================================
# Redis Configuration
# ================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_POOL_SIZE=20
REDIS_SERVER=redis

# Redis Key Prefixes
REDIS_SESSION_PREFIX=cap:session:
REDIS_CACHE_PREFIX=cap:cache:
REDIS_RATE_LIMIT_PREFIX=cap:rate_limit:
REDIS_LOCK_PREFIX=cap:lock:

# ================================
# RabbitMQ Configuration (Optional)
# ================================
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_USER=cap_user
RABBITMQ_PASSWORD=cap_password
RABBITMQ_VHOST=cap_vhost
RABBITMQ_SERVER=rabbitmq

# ================================
# Qdrant Configuration (Vector Database)
# ================================
QDRANT_HOST=qdrant
QDRANT_PORT=6333
QDRANT_API_KEY=
QDRANT_SERVER=qdrant

# ================================
# Celery Configuration
# ================================
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true
CELERY_WORKER_PREFETCH_MULTIPLIER=1
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000
CELERY_WORKER_CONCURRENCY=4

# ================================
# Email Configuration
# ================================
SMTP_TLS=true
SMTP_PORT=587
SMTP_HOST=
SMTP_USER=
SMTP_PASSWORD=
EMAILS_FROM_EMAIL=
EMAILS_FROM_NAME=CAP Platform
EMAIL_RESET_TOKEN_EXPIRE_HOURS=1
EMAIL_VERIFICATION_TOKEN_EXPIRE_HOURS=24
EMAIL_TEMPLATES_DIR=app/templates

# ================================
# SMS/Phone Configuration (Twilio)
# ================================
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=
SMS_VERIFICATION_CODE_EXPIRE_MINUTES=5
SMS_VERIFICATION_CODE_LENGTH=6

# ================================
# AI/LLM Configuration
# ================================
OPENAI_API_KEY=
OPENAI_ORGANIZATION=
ANTHROPIC_API_KEY=
DEFAULT_LLM_PROVIDER=openai
DEFAULT_LLM_MODEL=gpt-3.5-turbo
DEFAULT_CHAT_MODEL=gpt-3.5-turbo
DEFAULT_EMBEDDING_MODEL=text-embedding-ada-002

# ================================
# File Processing Configuration
# ================================
UPLOAD_DIR=/app/uploads
TEMP_DIR=/tmp
MAX_FILE_SIZE_MB=50
CHUNK_SIZE=1000
CHUNK_OVERLAP=200

# Allowed file types (comma-separated string or JSON list)
ALLOWED_FILE_TYPES=pdf,docx,txt,csv,json,html
# Example JSON format: ALLOWED_FILE_TYPES=["pdf","docx","txt","csv","json","html"]

# ================================
# Vector Database Configuration
# ================================
VECTOR_DIMENSION=1536
SIMILARITY_THRESHOLD=0.7

# ================================
# Rate Limiting Configuration
# ================================
RATE_LIMIT_LOGIN_ATTEMPTS=5
RATE_LIMIT_REGISTRATION_ATTEMPTS=3
RATE_LIMIT_PASSWORD_RESET_ATTEMPTS=3
RATE_LIMIT_API_CALLS_PER_MINUTE=100
RATE_LIMIT_BULK_OPERATIONS_PER_HOUR=10

# ================================
# Password Policy Configuration
# ================================
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL_CHARS=true

# ================================
# Account Security Configuration
# ================================
ACCOUNT_LOCKOUT_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION_MINUTES=30

# ================================
# Session Security Configuration
# ================================
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax

# ================================
# Credit System Configuration
# ================================
DEFAULT_FREE_CREDITS=1000
CREDIT_COST_PER_1K_TOKENS=0.01
CREDIT_COST_PER_MINUTE_VOICE=0.1
CREDIT_COST_PER_PHONE_MINUTE=0.05
LOW_CREDIT_THRESHOLD_PERCENT=20
CREDIT_USAGE_ALERT_THRESHOLD=100

# ================================
# Logging Configuration
# ================================
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE_PATH=logs/app.log
LOG_MAX_SIZE_MB=100
LOG_BACKUP_COUNT=5

# ================================
# Monitoring Configuration
# ================================
ENABLE_METRICS=true
METRICS_PORT=8001
SENTRY_DSN=

# ================================
# Testing Configuration
# ================================
TESTING=false
TEST_DATABASE_URL=

# ================================
# Development vs Production Examples
# ================================

# For Development (default values above)
# DEBUG=true
# ENVIRONMENT=development
# POSTGRES_SERVER=localhost
# REDIS_HOST=localhost
# QDRANT_HOST=localhost

# For Production (override these values)
# DEBUG=false
# ENVIRONMENT=production
# SECRET_KEY=your-production-secret-key-must-be-very-secure-and-long
# POSTGRES_SERVER=your-production-db-host
# POSTGRES_PASSWORD=your-secure-db-password
# REDIS_HOST=your-production-redis-host
# SMTP_HOST=your-smtp-provider.com
# SMTP_USER=your-smtp-username
# SMTP_PASSWORD=your-smtp-password
# EMAILS_FROM_EMAIL=noreply@yourdomain.com
# OPENAI_API_KEY=your-openai-api-key
# SENTRY_DSN=your-sentry-dsn-for-error-tracking

# ================================
# Docker Compose Service Names
# ================================
# When using Docker Compose, use these service names:
# POSTGRES_SERVER=postgres
# MONGODB_SERVER=mongodb  
# REDIS_HOST=redis
# RABBITMQ_HOST=rabbitmq
# QDRANT_HOST=qdrant

# ================================
# External Service Integration
# ================================
# Add your API keys and service configurations here:

# OpenAI Configuration
# OPENAI_API_KEY=sk-your-openai-api-key
# OPENAI_ORGANIZATION=org-your-organization-id

# Anthropic Configuration  
# ANTHROPIC_API_KEY=sk-ant-your-anthropic-key

# Twilio Configuration
# TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# TWILIO_AUTH_TOKEN=your-twilio-auth-token
# TWILIO_PHONE_NUMBER=+1234567890

# Email Provider (SendGrid, AWS SES, etc.)
# SMTP_HOST=smtp.sendgrid.net
# SMTP_USER=apikey
# SMTP_PASSWORD=your-sendgrid-api-key
# EMAILS_FROM_EMAIL=noreply@yourdomain.com

# Sentry Error Tracking
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id